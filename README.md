# Node.js 端口转发工具

一个功能强大的 Node.js 应用，用于管理多种类型的转发规则，提供友好的 Web 界面。

## 功能

- 支持多种转发类型：
  - TCP端口转发（例如：8899 → 127.0.0.1:8800）
  - SOCKS代理转发（可连接到SOCKS代理服务器）
  - HTTP代理转发（可连接到HTTP代理服务器）
  - Unix Socket转发（Linux/macOS）
  - Windows命名管道转发
- 系统端口监控：
  - 显示当前系统上所有已使用的端口
  - 标记被应用程序占用的端口
  - 显示端口的详细信息（进程名称、PID、协议等）
  - 支持搜索和过滤功能
- 通过 Web 界面配置和管理多个转发规则
- 支持指定源IP地址进行绑定，或绑定到所有地址(0.0.0.0)
- 可以添加、删除、启用、禁用转发规则
- 配置自动保存到文件，应用重启后自动恢复
- 友好的用户界面，显示转发状态和错误信息

## 安装

确保你已经安装了 [Node.js](https://nodejs.org/)，然后按照以下步骤操作：

1. 克隆或下载此仓库
2. 在项目目录中运行以下命令安装依赖：

```bash
npm install
```

## 使用方法

启动应用：

```bash
node server.js
```

然后在浏览器中访问 http://localhost:3000 来使用 Web 界面。

### 添加TCP端口转发

1. 在转发类型下拉框中选择"TCP端口转发"
2. 在表单中填写源IP地址（可选，留空表示绑定到所有地址 0.0.0.0）
3. 填写源端口（如 8899）
4. 填写目标主机（如 127.0.0.1）
5. 填写目标端口（如 8800）
6. 点击"添加转发规则"按钮

这样就会创建一个TCP转发规则，例如从本机的特定IP 192.168.1.100 和端口 8899 转发到 127.0.0.1:8800。

### 添加SOCKS代理转发

1. 在转发类型下拉框中选择"SOCKS代理转发"
2. 填写监听端口（如 8888）- 您的应用会连接到这个端口
3. 填写代理服务器地址（如 127.0.0.1）
4. 填写代理服务器端口（如 10020）
5. 点击"添加转发规则"按钮

这将设置一个转发，将本地8888端口的连接通过SOCKS代理服务器（127.0.0.1:10020）进行转发。

### 添加HTTP代理转发

1. 在转发类型下拉框中选择"HTTP代理转发"
2. 填写监听端口（如 8888）
3. 填写代理服务器地址（如 127.0.0.1）
4. 填写代理服务器端口（如 8800）
5. 点击"添加转发规则"按钮

这将设置一个转发，将本地8888端口的连接通过HTTP代理服务器（127.0.0.1:8800）进行转发。

### 添加Unix Socket转发（Linux/macOS）

1. 在转发类型下拉框中选择"Unix Socket转发"
2. 填写源地址（如 /tmp/my.sock）
3. 填写目标地址（可以是另一个socket路径如 /tmp/target.sock，或是TCP地址如 127.0.0.1:8800）
4. 点击"添加转发规则"按钮

### 添加Windows命名管道转发

1. 在转发类型下拉框中选择"Windows命名管道转发"
2. 填写源地址（如 myPipe 或 \\\\.\\pipe\\myPipe）
3. 填写目标地址（可以是另一个命名管道如 targetPipe，或是TCP地址如 127.0.0.1:8800）
4. 点击"添加转发规则"按钮

### 查看系统端口

1. 点击"系统端口"标签页
2. 查看当前系统上所有使用中的端口
3. 绿色表示被本应用使用的端口，红色表示被其他程序使用的端口
4. 悬停在端口上可以查看详细信息
5. 使用搜索框可以按端口或进程名称搜索
6. 使用过滤器可以选择只显示特定类型的端口
7. 点击"刷新"按钮可以更新端口列表

### 管理转发规则

- **启动/停止**：点击对应规则旁边的"启动"或"停止"按钮
- **删除**：点击对应规则旁边的"删除"按钮

## 注意事项

- 使用管理员权限运行可以使用低端口（如 1-1024）
- 如果源端口已经被占用，转发将会失败并显示错误信息
- 如果指定了源IP地址，确保该IP地址在您的系统上可用
- SOCKS代理转发需要目标是一个有效的SOCKS代理服务器
- HTTP代理转发支持标准的HTTP代理协议，同时也支持HTTPS隧道
- Unix Socket文件将在应用启动时自动删除已存在的文件
- Windows命名管道需要完整的路径格式，会自动添加前缀 \\\\.\\pipe\\ 如果没有指定
- 系统端口显示功能在Windows系统上使用netstat命令，在Unix系统上使用lsof命令
- 该应用会在后台自动保存配置到 `config.json` 文件

## 开发

本项目使用以下技术：

- Express.js：Web 框架
- EJS：模板引擎
- Node.js 原生 net 模块：实现多种转发功能
- socks-proxy-agent：实现SOCKS代理功能
- find-process：用于获取进程信息

## 许可

MIT 
